# テーマ構成・デザイン仕様書

## 1. デザインコンセプト
*   **ターゲット**: ポッドキャストリスナー
*   **スタイル**: SNS風カード型UI（GeneratePressベース）
*   **特徴**:
    *   コンテンツを「カード」として視覚的に独立させる。
    *   画像を効果的に配置し、視認性を高める。
    *   ポッドキャスト再生への導線を短縮する。

## 2. 技術スタック
*   **親テーマ**: [GeneratePress](https://wordpress.org/themes/generatepress/)
*   **子テーマ**: `generatepress-child`
    *   カスタマイズは基本的に子テーマに対して行う。
*   **CSS/JS**: 子テーマ内の `style.css` および `functions.php` で管理。
*   **ポッドキャストプラグイン**: Seriously Simple Podcasting (想定)

## 3. レイアウト仕様 (確定)

### 3.1 投稿一覧 (アーカイブページ)
Twitter (X) 風の「縦スクロール・タイムライン」をベースにしつつ、PCでは CSS Grid を用いた独自の2カラム構成を採用。

*   **PCレイアウト構成**:
    *   **コンテナ**: CSS Grid による2カラム (`minmax(0, 1fr) 300px`)。
    *   **メインエリア (左側・1fr)**:
        *   カード型リストを表示。
        *   無限スクロール（未実装・予定）。
    *   **サイドエリア (右側・300px固定)**:
        *   Hook: `generate_after_primary_content_area` を使用して注入。
        *   **要素**:
            1.  **高機能プレイヤー (Sticky)**: `position: sticky` で画面上部に固定。
            2.  **広告枠**: プレイヤーの下に**1枠**配置（Fix固定）。
        *   **連動動作**:
            *   「スマートヘッダー」の動きに連動して、サイドバーの `top` 位置が自動調整されるJS実装済み。

### 3.2 ヘッダー仕様 (New)
*   **スマートヘッダー**:
    *   `position: fixed` で常時上部に配置。
    *   **下スクロール**: アニメーションして画面外へ隠れる。
    *   **上スクロール**: 即座に再表示される。
    *   右サイドバー（プレイヤー）もこの動きに合わせて上下にスライドし、重なりを防ぐ。

*   **カード内の要素 (タイムライン)**:
    1.  **タイトル**: 記事タイトル。
    2.  **投稿日時**: メタ情報。
    3.  **再生ボタン (Play Episode)**:
        *   フック `generate_after_entry_header` でタイトルの下に挿入済み。
        *   クリックすると、右側の「固定プレイヤー」で再生が開始される（JS制御）。
        *   再生中は「Pause」表示に切り替わる。

## 4. 技術実装の検討事項 (プレイヤー連携)

「無限スクロール」かつ「再生を途切れさせない」要件は、通常のWordPressページ遷移と競合するため、工夫が必要です。

*   **無限スクロール実装**:
    *   WordPressプラグイン (例: Ajax Load More, Infinite Scroll) を利用するか、GeneratePressの機能（PremiumならBlogモジュールがあるが今回は無料版なので自作かプラグイン）を使用する。
    *   無限スクロール自体は、同じページ内でのコンテンツ追加なので、プレイヤーの再生は途切れません。
*   **ページ遷移とプレイヤー**:
    *   **課題**: ユーザーがカードをクリックして「詳細ページ」へ遷移すると、ブラウザがリロードされるため、右側のプレイヤーの音声は**必ず停止します**。
    *   **対策案**:
        *   **案A (SPA風)**: Barba.js 等を使用して、ページ遷移を非同期(Ajax)化し、プレイヤー部分のDOMを書き換えないようにする。実装難易度は高い。
        *   **案B (ポップアップ)**: 詳細ページへのリンクを「モーダルウィンドウ」で開くようにし、親ページのプレイヤーを残す。
        *   **案C (妥協案)**: 詳細ページ遷移時は再生停止を受け入れる。ただし「新しいタブで開く」を推奨するUIにする。
    *   ※ 現時点では、無限スクロール中の再生継続は容易ですが、詳細ページ遷移時の継続は「SPA化」が必要ないしは高コストであることを認識しておく必要があります。

## 5. 開発プロセス
GeneratePress **無料版** の機能をベースに、子テーマでの開発を行う。

1.  子テーマ (`generatepress-child`) の作成と有効化。
2.  **右サイドバーレイアウトの構築**:
    *   GeneratePressのデフォルト2カラム設定を利用しつつ、CSS Flexbox/Gridで左寄せと固定配置を調整する。
3.  **テンプレートカスタマイズ**:
    *   記事ループ内に「日本語/英語」2つのボタンを出力するロジックを実装（カスタムフィールド等を利用）。
4.  **JavaScriptプレイヤー実装**:
    *   右側の固定プレイヤーと、各カードのボタンを連動させるJS制御を実装。
    *   無限スクロールライブラリ (例: Infinite Scroll) の導入。
